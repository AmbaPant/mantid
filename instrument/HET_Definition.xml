<?xml version="1.0" encoding="UTF-8"?>
<!-- For help on the notation used to specify an Instrument Definition File 
     see http://www.mantidproject.org/IDF -->
<instrument xmlns="http://www.mantidproject.org/IDF/1.0" 
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xsi:schemaLocation="http://www.mantidproject.org/IDF/1.0 http://schema.mantidproject.org/IDF/1.0/IDFSchema.xsd"
 name="HET" valid-from   ="1900-01-31 23:59:59"
                       valid-to     ="2100-01-31 23:59:59"
               last-modified="2017-06-08 00:00:00">

<defaults>
    <length unit="meter"/>
    <angle unit="degree"/>
    <location x="0.0" y="0.0" z="0.0" rot="0.0" 
                      axis-x="0.0" axis-y="0.0" axis-z="1.0"/>
    <reference-frame>
       <!-- The z-axis is set parallel to and in the direction of the beam. the 
        y-axis points up and the coordinate system is right handed. -->
       <along-beam axis="z"/>
       <pointing-up axis="y"/>
       <handedness val="right"/>
       <origin val="beam" />       
    </reference-frame>
     <!-- Comment "components-are-facing" out if you dont want the
     components defined in this file to face a position by default -->    
     <components-are-facing x="0.0" y="0.0" z="0.0" />
</defaults>    
  
  <!-- BRIEF DESCRIPTION OF INSTRUMENT: 
  
       Assume for now the instrument consists of one bank and all detector positions
       are given relative to the sample. 
  -->
  
  
  <!-- LIST OF PHYSICAL COMPONENTS (which the instrument consists of) -->
  
  <!-- detector components -->

   <component type="monitors" idlist="monitors">
     <location/>
  </component>

  <component type="Low angle PSD"  idlist="Low angle PSD">
    <location/>
  </component>
  
  <component type="Mid-angle tubes"  idlist="Mid-angle tubes">
    <location/>
  </component>
  
 

  <!-- source and sample-position components -->

  <component type="undulator">
    <location z="-11.818"/>
  </component>

  <component type="nickel-holder">
  <location />
  </component>


  <!-- DEFINITION OF TYPES -->

  <!-- Source types -->

  <type name="undulator" is="Source">
    <properties />
  </type>
  
  <!-- Sample-position types -->

  <type name="nickel-holder" is="SamplePos">
    <properties />
  </type>  
  <!-- Detectors types -->
   <type name="monitors">
     <component type="monitor">
     <location r="-3.51 " name="monitor1" />
     <location r="-1.615" name="monitor2"  />
     <location r="5.694"  name="monitor3" />
     <location r="4.02"      name="missing monitor" />
     </component>
   </type>

<type name="Low angle PSD">
    <component type="D1_West">
        <location  z="4.02">  <facing x="0" y="0" z="0"/> </location>  
    </component> 
    <component type="D1_East">
        <location  z="4.02">  <facing x="0" y="0" z="0"/> </location>  
    </component>
    <component type="D2_North">
        <location  z="4.02">  <facing x="0" y="0" z="0"/> </location>  
    </component>
    <component type="D2_South">
        <location  z="4.02">  <facing x="0" y="0" z="0"/> </location>  
    </component>
 </type>
<type name="Mid-angle tubes">
    <component type="W1-W">
        <location  r="2.5" p="0." rot="0."/>    
    </component>
    <component type="W1-SW">
        <location  r="2.5" p="-45" rot="-45."  axis-x="1.0" axis-y="0.0" axis-z="0.0"/>
    </component>
    
</type>
 
  <type name="D1_West">
    <component type="HET_long_PSDtube" outline="yes">
        <location  x=" 0.1750"   name="tube1" />    
        <location  x=" 0.2021"   name="tube2" />
        <location  x=" 0.2292"   name="tube3" />
        <location  x=" 0.2562"   name="tube4" />
        <location  x=" 0.2833"   name="tube5" />
        <location  x=" 0.3104"   name="tube6" />
        <location  x=" 0.3375"   name="tube7" />
        <location  x=" 0.3646"   name="tube8" />
        <location  x=" 0.3917"   name="tube9" />
        <location  x=" 0.4188"   name="tube10" />
        <location  x=" 0.4458"   name="tube11" />
        <location  x=" 0.4729"   name="tube12" />
        <location  x=" 0.5000"   name="tube13" />
    </component>
  </type>
  <type name="D1_East">
    <component type="HET_long_PSDtube" outline="yes">
        <location  x="-0.1750" name="tube1" />    
        <location  x="-0.2021" name="tube2" />
        <location  x="-0.2292" name="tube3" />
        <location  x="-0.2562" name="tube4" />
        <location  x="-0.2833" name="tube5" />
        <location  x="-0.3104" name="tube6" />
        <location  x="-0.3375" name="tube7" />
        <location  x="-0.3646" name="tube8" />
        <location  x="-0.3917" name="tube9" />
        <location  x="-0.4188" name="tube10" />
        <location  x="-0.4458" name="tube11" />
        <location  x="-0.4729" name="tube12" />
        <location  x="-0.5000" name="tube13" />
    </component>
  </type>
  <type name="D2_North">
    <component type="HET_short_PSDtube" outline="yes">
        <location  x="-0.1200" y="0.16" name="tube1" />    
        <location  x="-0.0933" y="0.16" name="tube2" />
        <location  x="-0.0667" y="0.16" name="tube3" />
        <location  x="-0.0400" y="0.16" name="tube4" />
        <location  x="-0.0133" y="0.16" name="tube5" />
        <location  x=" 0.0133" y="0.16" name="tube6" />
        <location  x=" 0.0400" y="0.16" name="tube7" />
        <location  x=" 0.0667" y="0.16" name="tube8" />
        <location  x=" 0.0933" y="0.16" name="tube9" />
        <location  x=" 0.1200" y="0.16" name="tube10" />
    </component>
  </type>
  <type name="D2_South">
    <component type="HET_short_PSDtube" outline="yes">
        <location  x="-0.1200" y="-0.5" name="tube1" />    
        <location  x="-0.0933" y="-0.5" name="tube2" />
        <location  x="-0.0667" y="-0.5" name="tube3" />
        <location  x="-0.0400" y="-0.5" name="tube4" />
        <location  x="-0.0133" y="-0.5" name="tube5" />
        <location  x=" 0.0133" y="-0.5" name="tube6" />
        <location  x=" 0.0400" y="-0.5" name="tube7" />
        <location  x=" 0.0667" y="-0.5" name="tube8" />
        <location  x=" 0.0933" y="-0.5" name="tube9" />
        <location  x=" 0.1200" y="-0.5" name="tube10" />
    </component>
  </type>

<type name = "W1-W">
    <component type="HET_non_PSDtube" outline="yes">
     <location  t="9.31" />  <!-- first two tubes in some way different from the following 30-->
     <location  t="9.94" />
     <location  t="10.56" />
     <location  t="10.56" />
     <location  t="11.19" />
     <location  t="11.81" />
     <location  t="12.44" />
     <location  t="13.06" />
     <location  t="13.69" />
     <location  t="14.31" />
     <location  t="14.94" />
     <location  t="15.56" />
     <location  t="16.19" />
     <location  t="16.81" />
     <location  t="17.44" />
     <location  t="18.06" />
     <location  t="18.69" />
     <location  t="19.31" />
     <location  t="19.94" />
     <location  t="20.56" />
     <location  t="21.19" />
     <location  t="21.81" />
     <location  t="22.44" />
     <location  t="23.06" />
     <location  t="23.69" />
     <location  t="24.31" />
     <location  t="24.94" />
     <location  t="25.56" />
     <location  t="26.19" />
     <location  t="26.81" />
     <location  t="27.44" />
     <location  t="28.69" />
     </component>
</type>
<type name = "W1-SW">
    <component type="HET_non_PSDtube" outline="yes">
     <location  t="-9.31"   />  <!-- first two tubes in some way different from the following 30-->
     <location  t="-9.94"  />
     <location  t="-10.56" />
     <location  t="-10.56" />
     <location  t="-11.19" />
     <location  t="-11.81" />
     <location  t="-12.44" />
     <location  t="-13.06" />
     <location  t="-13.69" />
     <location  t="-14.31" />
     <location  t="-14.94" />
     <location  t="-15.56" />
     <location  t="-16.19" />
     <location  t="-16.81" />
     <location  t="-17.44" />
     <location  t="-18.06" />
     <location  t="-18.69" />
     <location  t="-19.31" />
     <location  t="-19.94" />
     <location  t="-20.56" />
     <location  t="-21.19" />
     <location  t="-21.81" />
     <location  t="-22.44" />
     <location  t="-23.06" />
     <location  t="-23.69" />
     <location  t="-24.31" />
     <location  t="-24.94" />
     <location  t="-25.56" />
     <location  t="-26.19" />
     <location  t="-26.81" />
     <location  t="-27.44" />
     <location  t="-28.69" />
     </component>
</type>

   <type name="HET_short_PSDtube" outline="yes">
 <component type="pixel">
   <locations y="0" y-end="0.34" n-elements="256" />
 </component>
 </type>
 
 <type name="HET_long_PSDtube" outline="yes">
 <component type="pixel">
   <locations y="-0.45" y-end="0.45" n-elements="256" />
 </component>
 </type>

<type name="HET_non_PSDtube" is="detector">     
  <cylinder id="shape">
      <centre-of-bottom-base x="0.0" y="-0.15" z="0.0" />
      <axis x="0.0" y="1.0" z="0" /> 
      <radius val="0.0125" />
      <height val="0.3" />
  </cylinder>
</type>  
 
<type name="monitor" is="monitor">
  <properties/>
  <cylinder id="some-shape">
     <centre-of-bottom-base r="0.0" t="0.0" p="0.0" />
 <axis x="0.0" y="0.0" z="1.0" />
 <radius val="0.01" />
 <height val="0.03" />
 </cylinder>
 <algebra val="some-shape" />
 </type>
 
 <type name="pixel" is="detector">
    <cylinder id="cyl-approx">
        <centre-of-bottom-base r="0.0" t="0.0" p="0.0" />
        <axis x="0.0" y="0.2" z="0.0" />
        <radius val="   0.127000E-01" />
        <height val="   0.391602E-02" />
    </cylinder>
    <algebra val="cyl-approx" />
</type>
 
<!-- MONITOR ID LISTS -->
<idlist idname="monitors">
     <id start="601" end="604"/>
</idlist>
 
<!-- DETECTOR ID LISTS -->
<idlist idname="Mid-angle tubes">
<!-- Spectra 101-132 -->  
  <id start="129" end="160" />
<!-- Spectra 133-164 -->    
  <id start="161" end="192" />  
</idlist>   
<idlist idname="Low angle PSD">
<!-- Spectra 401-1232 -->  
  <id start="213001" end="213256" />
  <id start="212001" end="212256" />
  <id start="211001" end="211256" />
  <id start="210001" end="210256" />
  <id start="209001" end="209256" />
  <id start="208001" end="208256" />
  <id start="207001" end="207256" />
  <id start="206001" end="206256" />
  <id start="205001" end="205256" />
  <id start="204001" end="204256" />
  <id start="203001" end="203256" />
  <id start="202001" end="202256" />
  <id start="201001" end="201256" />
<!-- Spectra 1233-2064 -->
  <id start="401001" end="401256" />
  <id start="402001" end="402256" />
  <id start="403001" end="403256" />
  <id start="404001" end="404256" />
  <id start="405001" end="405256" />
  <id start="406001" end="406256" />
  <id start="407001" end="407256" />
  <id start="408001" end="408256" />
  <id start="409001" end="409256" />
  <id start="410001" end="410256" />
  <id start="411001" end="411256" />
  <id start="412001" end="412256" />
  <id start="413001" end="413256" />
<!-- Spectra 2065-2324 -->
  <id start="101001" end="101256"/>
  <id start="102001" end="102256"/>
  <id start="103001" end="103256"/>
  <id start="104001" end="104256"/>
  <id start="105001" end="105256"/>
  <id start="106001" end="106256"/>
  <id start="107001" end="107256"/>
  <id start="108001" end="108256"/>
  <id start="109001" end="109256"/>
  <id start="110001" end="110256"/>
<!-- Spectra 2325-2584 -->
  <id start="301001" end="301256"/>
  <id start="302001" end="302256"/>
  <id start="303001" end="303256"/>
  <id start="304001" end="304256"/>
  <id start="305001" end="305256"/>
  <id start="306001" end="306256"/>
  <id start="307001" end="307256"/>
  <id start="308001" end="308256"/>
  <id start="309001" end="309256"/>
  <id start="310001" end="310256"/>
</idlist>
  

      <!-- These detectors exist in the ISIS raw file but are not
     believed to physical exist on the instrument
    <id start="414001" end="414256" />
    <id start="415001" end="415256" />    
    <id start="601001" end="601040" />
    <id start="701001" end="703048" />
    <id start="704001" end="706048" />
    <id start="707001" end="709048" />
    <id start="710001" end="712048" />
    <id start="713001" end="715048" />
    <id start="716001" end="718048" />
    -->

  
 <!--DETECTOR PARAMETERS-->
  <component-link name="monitors">
   <parameter name="DelayTime">
      <value units="microseconds" val="0"/>
   </parameter>
  </component-link>
    
  <!-- General defaults for instrument -->
  <component-link name="HET">
    <parameter name="TubePressure">
      <value units="atm" val="10.0"/>
    </parameter>
    <parameter name="TubeThickness">
      <value units="metre" val="0.0008"/>
    </parameter>
    <parameter name="DelayTime">
      <value units="microseconds" val="-5.3"/>
    </parameter>
  </component-link>
</instrument>
