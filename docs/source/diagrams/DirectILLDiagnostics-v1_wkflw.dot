digraph DirectILLDiagnostics {
  label = "DirectILLDiagnostics workflow diagram"
  $global_style

  subgraph params {
    $param_style
    bkgExcludeWidth [label="NonBkgRegionInSigmas"]
    bkgThresholds [label="Bkg thresholds"]
    elasticPeakWidth [label="ElasticPeakWidthInSigmas"]
    inputEPP [label="EPPWorkspace"]
    inputWS [label="InputWorkspace"]
    maskIndices [label="MaskedDetectors"]
    maskComponents [label="MaskedComponents"]
    outputDiagnostics [label="OutputWorkspace"]
    peakThresholds [label="Peak thresholds"]
  }

  subgraph algorithms {
    $algorithm_style
    DiagnoseBkg [label="Diagnose flat backgrounds"]
    DiagnosePeaks [label="Diagnose elastic peaks"]
    IntegrateBkg [label="Integrate backgrounds"]
    IntegratePeaks [label="Integrate elastic peak"]
    Plus [label="Plus"]
  }

  subgraph values {
    $value_style
    bkgDiagnostics [label="Background diagnostics workspace"]
    peakDiagnostics [label="Peak diagnostics workspace"]
  }

  subgraph decisions {
    $decision_style
  }

  inputWS -> IntegratePeaks
  inputEPP -> IntegratePeaks
  elasticPeakWidth -> IntegratePeaks
  inputWS -> IntegrateBkg
  inputEPP -> IntegrateBkg
  bkgExcludeWidth -> IntegrateBkg
  IntegratePeaks -> DiagnosePeaks
  peakThresholds -> DiagnosePeaks
  DiagnosePeaks -> peakDiagnostics
  IntegrateBkg -> DiagnoseBkg
  bkgThresholds -> DiagnoseBkg
  DiagnoseBkg -> bkgDiagnostics
  peakDiagnostics -> Plus
  bkgDiagnostics -> Plus
  maskIndices -> Plus
  maskComponents -> Plus
  Plus -> outputDiagnostics
}
